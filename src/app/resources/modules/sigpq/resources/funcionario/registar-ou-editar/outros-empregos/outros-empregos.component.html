<div class="row">
    <div class="container-fluid">
        <div id="historico-processo-individual" class="w-100">
            <div class="row">
                <div class="col-lg-12 col-xl-12 col-md-12 col-sm-12 ms-auto">
                    <form class="m-0 w-100" [formGroup]="this.simpleForm">
                        <div class="card mt-0 py-0" style="border-radius: 0px">
                            <div class="row p-2" style="row-gap: 1.2rem">
                                <!-- Campo: Empresa -->
                                <div class="col-lg-8">
                                    <label for=""><b>Empresa<span class="text-red">*</span></b></label>
                                    <!-- <ng-select2 [options]="options" formControlName="empresa_id" [data]="this.listaEmpresas"
                                        >
                                    </ng-select2> -->
                                    <input class="form-control" type="text" formControlName="empresa"
                                        placeholder="Digite a empresa" />
                                </div>

                                <!-- Campo: Cargo -->
                                <div class="col-lg-4">
                                    <label for=""><b>Cargo/Função Exercida<span class="text-red">*</span></b></label>
                                    <input class="form-control" type="text" formControlName="cargo"
                                        placeholder="Digite o cargo/função" />
                                </div>

                                <!-- Campo: Ano de Início -->
                                <div class="col-lg-2">
                                    <label for=""><b>Ano de Início<span class="text-red">*</span></b></label>
                                    <input class="form-control" type="text" formControlName="ano_inicio" maxlength="4"
                                        (input)="validateInput($event)"
                                        placeholder="Ano de início (ex: 2020)" />
                                    <div *ngIf="this.simpleForm.controls?.ano_inicio?.dirty &&
                                               this.simpleForm.controls?.ano_inicio?.errors">
                                        <div *ngIf="this.simpleForm.controls?.ano_inicio?.errors?.pattern"
                                            style="color: #dc3545">
                                            Digite somente números.
                                        </div>
                                        <div *ngIf="this.simpleForm.controls?.ano_inicio?.errors?.minlength ||
                                                     this.simpleForm.controls?.ano_inicio?.errors?.maxlength"
                                            style="color: #dc3545">
                                            O campo deve ter exatamente 4 dígitos.
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo: Ano de Fim -->
                                <div class="col-lg-2">
                                    <label for=""><b>Ano de Fim</b></label>
                                    <input class="form-control" type="text" formControlName="ano_fim" maxlength="4"
                                        (input)="validateInput($event)"
                                        placeholder="Ano de fim (ex: 2022)" />
                                    <div *ngIf="this.simpleForm.controls?.ano_fim?.dirty &&
                                               this.simpleForm.controls?.ano_fim?.errors">
                                        <div *ngIf="this.simpleForm.controls?.ano_fim?.errors?.pattern"
                                            style="color: #dc3545">
                                            Digite somente números.
                                        </div>
                                        <div *ngIf="this.simpleForm.controls?.ano_fim?.errors?.minlength ||
                                                     this.simpleForm.controls?.ano_fim?.errors?.maxlength"
                                            style="color: #dc3545">
                                            O campo deve ter exatamente 4 dígitos.
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo: Tipo de Contrato -->
                                <div class="col-lg-4">
                                    <label for=""><b>Tipo de Contrato<span class="text-red">*</span></b></label>
                                    <ng-select2 [options]="options" formControlName="tipo_de_contrato"
                                        [data]="this.tiposContrato">
                                    </ng-select2>
                                </div>

                                <!-- Campo: Anexo -->
                                <div class="col-lg-4">
                                    <label for="anexo-curso"><b>Anexo (formato pdf)</b></label>
                                    <input id="anexo-curso" type="file" class="form-control" accept="application/pdf"
                                        (change)="this.uploadFile($event, 'anexo')" />
                                    <p id="text_"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Botões de Ação -->
                        <div class="row px-2" style="row-gap: 1.2rem">
                            <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 d-flex justify-content-end align-items-center my-2">
                                <button class="btn-piips btn-piips-red m-0 py-1" (click)="this.reiniciarFormulario()">
                                    Cancelar
                                </button>
                                <button [disabled]="this.isLoading || this.submitted || !this.simpleForm.valid"
                                    type="button" (click)="onSubmit()" class="btn-piips btn-piips-primary m-0 py-1"
                                    style="border-radius: 0px">
                                    <ng-container *ngIf="this.isLoading || this.submitted; else naoRegistar">
                                        <div class="spinner-border spinner-border-sm m-1"></div>
                                        Carregando...
                                    </ng-container>
                                    <ng-template #naoRegistar>
                                        {{ this.buscarId ? 'Salvar' : 'Registrar' }}
                                    </ng-template>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Tabela de Histórico -->
            <div class="row my-4">
                <div class="col-md-12">
                    <nav class="navbar navbar-light bg-light w-100">
                        <div class="form-inline align-items-center d-flex justify-content-between w-100">
                            <div class="d-flex justify-content-start">
                                <select class="form-control mr-sm-1" (change)="filtrarPagina('perPage', $event)">
                                    <option *ngFor="let item of [5, 10, 20, 50]" [value]="item">{{ item }}</option>
                                </select>
                                <input class="form-control mr-sm-1" type="text" [ngModel]="filtro.search"
                                    name="search" placeholder="Pesquisa ..."
                                    (ngModelChange)="filtrarPagina('search', $event)" />
                                <button class="btn-piips btn-piips-primary m-0" (click)="this.recarregarPagina()">
                                    <i style="font-size: 14px" class="fa fa-refresh fa-spin fa-3x fa-fw"></i>
                                    <b>Recarregar</b>
                                </button>
                            </div>
                        </div>
                    </nav>
                </div>

                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <div class="table-responsive">
                        <table class="table table-border table-striped custom-table datatable mb-0">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Empresa</th>
                                    <th>Cargo</th>
                                    <th>Ano de Início</th>
                                    <th>Ano de Fim</th>
                                    <th>Tipo de Contrato</th>
                                    <th>Data de Registo</th>
                                    <th>Data de Actualização</th>
                                    <th class="text-right">Operação</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of this.historico | paginate: { id: 'historicoId', itemsPerPage: this.pagination.per_page, currentPage: this.pagination.current_page, totalItems: this.pagination.total }; index as i">
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ item.empresa | uppercase }}</td>
                                    <td>{{ item.cargo | uppercase }}</td>
                                    <td>{{ item.ano_inicio }}</td>
                                    <td>{{ item.ano_fim }}</td>
                                    <td>{{ item.tipo_de_contrato | uppercase }}</td>
                                    <td>{{ item.created_at }}</td>
                                    <td>{{ item.updated_at }}</td>
                                    <td class="text-right">
                                        <div class="dropdown dropdown-action position-static">
                                            <a href="#" class="action-icon dropdown-toggle" data-toggle="dropdown"
                                                aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
                                            <div class="dropdown-menu">
                                                <a class="dropdown-item" (click)="setItem(item)"
                                                    href="javascript:void(0)">
                                                    <i class="fa fa-edit m-r-5"></i>
                                                    Editar
                                                </a>
                                                <a class="dropdown-item" href="javascript:void(0)"
                                                    (click)="visualizar(item)">
                                                    <i class="fa fa-eye m-r-5"></i>
                                                    Visualizar
                                                </a>
                                                <a class="dropdown-item" href="#" (click)="construcao()"
                                                    data-toggle="modal" data-target="#delete_historico">
                                                    <i class="fa fa-trash-o m-r-5"></i> Eliminar
                                                </a>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Paginação -->
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-sm-6">
                            Mostrando de {{ this.pagination.current_page }} á
                            {{ this.pagination.per_page }} de {{ this.pagination.total }} Registos
                        </div>
                        <div class="col-sm-6">
                            <div class="float-right">
                                <pagination-controls id="historicoId" (pageChange)="this.filtrarPagina('page', $event)"
                                    [directionLinks]="true" [autoHide]="false" previousLabel="Anterior"
                                    nextLabel="Próximo" [maxSize]="4" [responsive]="true"></pagination-controls>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="modalEmprego" class="modal secand-modal" tabindex="-1" role="dialog" style="display:none;" aria-hidden="true">
    <div class="modal-dialog" role="document" style="overflow-y: hidden;min-width: 70%;">
      <div class="modal-content">
        <div class="modal-header">
          <h5>
            <i class="fa fa-user"></i>
            Visualizar documento
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="closeModal('modalEmprego')">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="content">
          <div class="modal-body">
            <div class="row">
  
              <div class="col-sm-12">
                <nav class="navbar navbar-light bg-light">
                  <h3>{{this.documento?.sigpq_tipo_documento_nome}}</h3>
                  <aside *ngIf="this.documento">
                    <span *ngIf="this.documento.activo" class="custom-badge status-green">Activo</span>
                    <span *ngIf="!this.documento.activo" class="custom-badge status-orange">Inactivo</span>
                  </aside>
                </nav>
                <div class="col-sm-12">
                  <aside *ngIf="carregarDocumento;else carregarDocumentoVerMensagem">
                    <div class="container">
                      <div class="row justify-content-center">
                        Carregando documento ...
                        <div class="col-sm-12 text-center">
                          <div class="spinner-border text-primary" style="width: 2rem; height: 2rem;" role="status">
                          </div>
                        </div>
                      </div>
                    </div>
                  </aside>
                  <ng-template #carregarDocumentoVerMensagem>
                    <aside *ngIf="fileUrl; else verMensagem">
                      <iframe [src]="fileUrl" width="100%" height="700px"></iframe>
                    </aside>
                    <ng-template #verMensagem>
                      <div class="container">
                        <div class="row justify-content-center">
                          <div class="col-sm-12 text-center">
                            Sem documento adicionado
                          </div>
                        </div>
                      </div>
                    </ng-template>
                  </ng-template>
                </div>
  
              </div>
  
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="closeModal('modalEmprego')">
              <span class="fa fa-close m-r-2"></span>Fechar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
