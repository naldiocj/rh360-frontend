 

<div class="content"> 
    <div class="header-ficha mt-1">
        <div class="row" style="align-items: center;">
            <div class="col-xl-8 col-lg-8 col-md-8 col-sm-12 d-flex justify-content-start align-items-start">
                <div class="mais-info d-flex justify-content-center align-items">
                    <h4 class="text-white"><b>Listagem dos Perfis</b></h4>
                </div>
            </div>
            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 d-flex justify-content-end align-items-start">
                <button type="button" [disabled]="isDisabled" flow="down" class="btn btn-primary"  (click)="this.registar()" data-toggle="modal"
                    data-target="#modalRegistarOuEditarUtilizador"><i class="fa fa-plus-circle"></i> Registar</button>
            </div>
        </div>
    </div>
    <div class="row" style="row-gap: .8rem;">
        <div class="col-xl-12 col-lg-12 col-md-col-12 col-sm-12 my-2">
            <form class="row" style="align-items: center;">
                <div class="col-xl-1 col-lg-1 col-md-6 col-sm-12">
                    <select class="form-control" style="width: 100%!important; padding: .8rem auto;"
                        (change)="filtrarPagina('perPage',$event)">
                        <option *ngFor="let item of [5,10,20,50]" [value]="item">{{item}}</option>
                    </select>
                </div>
                <div class="col-xl-9 col-lg-9 col-md-12 col-sm-12">
                    <input class="form-control w-100" type="text" [ngModel]="this.filtro.search"
                        (ngModelChange)="filtrarPagina('search',$event)" placeholder="Pesquisa ...">
                </div>
                <div class="col-xl-2 col-lg-2 col-md-12 col-sm-12 d-flex justify-content-end align-items-center">
                    <button (click)="this.recarregarPagina()" class="btn-piips btn-piips-secondary m-0" type="submit">
                        <i style="font-size: 14px;" class="fa fa-refresh fa-spin fa-3x fa-fw"></i>
                        <b>Recarregar</b>
                    </button>
                </div>
            </form>

        </div>
        

        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
            <table class="table table-border custom-table datatable mb-0">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Codinome</th>
                        <th>Perfil</th>
                        <th>Genero</th>
                        <th>Estado Civil</th>
                        <th>Estado</th>
                        <th>Colocação</th>
                        <th>Data de Registado </th>
                        <th class="text-center">Operação</th>
                    </tr>
                </thead>
                <tbody>
                  
                    <tr
                        *ngFor="let item of utilizadores | paginate: { itemsPerPage: this.pagination.per_page, currentPage: this.pagination.current_page,totalItems: this.pagination.total,id:'idUtilizadorTable' }; index as i" 
                        [class.selected]="isSelected(item)"
                        (click)="toggleSelection(item)">
                        <td>{{this.totalBase + i}}</td>
                         
                        <td>{{item.codinome}}</td>
                        <td><a routerLink="/"
                            ariaCurrentWhenActive="page"
                            [routerLink]="['/piips/sigpg/perfil/', item.funcionario_id]">
                            {{item.tipo_perfil_nome}}
                        </a>
                    </td>
                        <td>{{item.funcionario[0].genero}}</td>
                        <td>{{item.funcionario[0].estado_civil_nome}}</td>
                        <td>
                            <ng-container *ngIf="item.activo; else elseTemplate">
                                <span class="custom-badge status-green">Activo</span>
                            </ng-container>
                            <ng-template #elseTemplate>
                                <span class="custom-badge status-red">Inactivo</span>
                            </ng-template>
                        </td>
                        <td>{{item.funcionario[0].sigpq_funcionario_orgao.nome_completo ?? 'S/N'}}</td>
                        
                        <td>{{item.formatted_created_at}}</td>
                        <!-- <td>{{item.updatedAt}}</td> -->
                        <td class="text-center">

                            <div class="dropdown dropdown-action">
                                <a href="#" class="action-icon dropdown-toggle" data-toggle="dropdown"
                                    aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>

                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="#"><i class="fa fa-eye m-r-5"></i>
                                        Visualizar</a>
                                    <a class="dropdown-item" href="javarcript::void(0)" data-toggle="modal"
                                        data-target="#modalRegistarOuEditarUtilizador" (click)="editar(item)">
                                        <i class="fa fa-pencil m-r-5"></i>
                                        Editar
                                    </a>
                                    <a class="dropdown-item" href="javarcript::void(0)" data-toggle="modal"
                                        data-target="#reset-password" (click)="visualizar(item)">
                                        <i class="fa fa-lock m-r-5"></i>
                                        Redefinir senha
                                    </a>
                                    <a class="dropdown-item" href="javarcript::void(0)" data-toggle="modal"
                                        data-target="#activa-desactiva-utilizador" (click)="visualizar(item)">
                                        <ng-container *ngIf="item.activo; else inActivo">
                                            <i class="fa fa-times m-r-5"></i>
                                            Desactivar
                                        </ng-container>
                                        <ng-template #inActivo>
                                            <i class="fa fa-check m-r-5"></i>
                                            Activar
                                        </ng-template>
                                    </a>
                                    <a class="dropdown-item" href="#" data-toggle="modal" (click)="visualizar(item)"
                                        data-target="#eliminar-utilizador"><i class="fa fa-trash-o m-r-5"></i>
                                        Eliminar</a>
                                </div>
                            </div>

                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="col-md-12">
            <div class="row">
                <div class="col-sm-6">
                    Mostrando de {{ this.pagination.current_page }} á
                    {{ this.pagination.per_page }} de {{ this.pagination.total }} Registo
                </div>
                <div class="col-sm-6">
                    <div class="float-right">
                        <pagination-controls id="idUtilizadorTable" (pageChange)="this.filtrarPagina('page', $event)"
                            [directionLinks]="true" [autoHide]="true" previousLabel="Anterior" nextLabel="Próximo"
                            [maxSize]="4" [responsive]="true"></pagination-controls>
                    </div>
                </div>
            </div>
        </div>

        <button (click)="confirmSelection()">Confirmar Seleção</button>
    </div>
</div>

<sigt-registar-ou-editar-modal (eventRegistarOuEditModel)="this.buscarUtilizadores()"
    ></sigt-registar-ou-editar-modal>