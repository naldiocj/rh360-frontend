<div class="modal fade " id="modalRegistarOuEditarDelituosofoto" aria-labelledby="modalRegistarOuEditarDelituosofoto" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalRegistarOuEditarDelituosoLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header bg-prima text-white">
          <h4 class="modal-title"><b>Registro de Delituoso</b></h4>
                <a
                (click)="stopCamera()"
                type="button"
                    data-bs-dismiss="modal" aria-label="Close"
                  >
                  <i  class="bi bi-backspace-reverse-fill cursor-pointer rounded-lg "
                  style="font-size: 1.2em"></i>
                  </a>
      </div>
          <form   (ngSubmit)="onSubmit()">
             
            <div class=" modal-body bg-light" >
              
                          <div class="tab-content" id="myTabContent">

                               <div id="foto" role="tabpanel" aria-labelledby="foto-civil-tab" tabindex="0">
                                <div class="row">
                                  <div class="col-12" >
                                    <p *ngIf="!isCameraSupported">Seu navegador não suporta acesso à câmera. Por favor, carregue as fotos manualmente.</p>
                                     
                                  </div>
                                   
                                  <div class="container camera-container row col-9">
                                    <ng-container *ngIf="useCamera; else manualUpload">
                                      <div class="col-10 video-wrapper">
                                        <video autoplay muted playsinline #videoContainer id="video"></video>
                                        <div #canvas id="canvasEL"></div>
                                      </div>
                                    </ng-container>
                                    <ng-template #manualUpload>
                                      <!-- Conteúdo alternativo -->
                                      <div class="col-12 ml-2">
                                        <p>Por favor, carregue as fotos manualmente:</p>

                                        <div  class="btn-group" role="group" >
                                           <div>
                                            <label for="fileFrontal" class="upload-label">
                                              Foto Frontal
                                            </label>
                                            <input type="file" id="fileFrontal" accept="image/*" (change)="handleFileUpload($event, 0)" hidden />
                                            </div>
                                        
                                          <div>
                                            <label for="fileLateralDireita" class="upload-label">
                                              Foto Lateral Direita
                                            </label>
                                            <input type="file" id="fileLateralDireita" accept="image/*" (change)="handleFileUpload($event, 1)" hidden />
                                            </div>
                                        
                                            <div>
                                              <label for="fileLateralEsquerda" class="upload-label">
                                                Foto Lateral Esquerda
                                              </label>
                                              <input type="file" id="fileLateralEsquerda" accept="image/*" (change)="handleFileUpload($event, 2)" hidden />
                                             </div>
                                          
                                             <div>
                                              <label for="fileNuca" class="upload-label">
                                                Foto da Nuca ou de tras
                                              </label>
                                              <input type="file" id="fileNuca" accept="image/*" (change)="handleFileUpload($event, 3)" hidden />
                                             </div>
                                            
                                        </div>
                                      </div>
                                    </ng-template>
                                     
                                    <div class="col-12">
                                      
                                      
                                      <!-- Câmera (Aparece se useCamera for verdadeiro) -->
                                      <div class="btn-group" role="group" aria-label="Basic example">
                                         
                                       <button  *ngIf="useCamera" type="button" class="btn btn-primary" (click)="toggleCamera()" [disabled]="isLoading">
                                           Abrir Câmera <i class="bi bi-camera2"></i>
                                        </button>
                                        <button *ngIf="isCameraSupported" type="button" class="btn btn-primary"  (click)="useCamera = !useCamera">
                                          {{ useCamera ? 'Usar Upload Manual' : 'Usar Câmera' }}
                                        </button>
                                      </div>
                                      <div class="btn-group" role="group" aria-label="Basic example" *ngIf="isCameraActive">
                                        <button type="button" class="btn btn-primary"(click)="captureLateralEsquerda()"><i class="bi bi-chevron-double-left"></i>Lateral Esquerda</button>
                                        <button type="button" class="btn btn-primary" (click)="captureFrontal()">Capturar Frontal <i class="bi bi-chevron-contract"></i></button>
                                        <button type="button" class="btn btn-primary"(click)="captureLateralDireita()">Lateral Direita <i class="bi bi-chevron-double-right"></i></button>
                                        <button type="button" class="btn btn-primary"(click)="captureNuca()">Nuca <i class="bi bi-chevron-double-right"></i></button>
                                      
                                      </div>
                                      
                                    </div>
                                  </div>
                                  <div class="col-3 captured-images">
                                    <div *ngIf="capturedImages.length > 0; else noImages">
                                       <!-- Captura de Imagem Frontal -->
                                      <div class="captured-image">
                                        <p  *ngIf="capturedImages[0]">Frontal</p>
                                        <img *ngIf="capturedImages[0]" [src]="capturedImages[0]" alt="Imagem Lateral Direita">
                                        <button *ngIf="capturedImages[0]" (click)="removeImage(0)"><i class="bi bi-x-circle-fill"></i></button>
                                      </div>

                                      <!-- Captura de Imagem Lateral Direita -->
                                      <div class="captured-image">
                                        <p *ngIf="capturedImages[1]">Lateral Direita</p>
                                        <img *ngIf="capturedImages[1]" [src]="capturedImages[1]" alt="Imagem Lateral Direita">
                                        <button *ngIf="capturedImages[1]" (click)="removeImage(1)"><i class="bi bi-x-circle-fill"></i></button>
                                      </div>

                                      <!-- Captura de Imagem Lateral Esquerda -->
                                      <div class="captured-image">
                                        <p *ngIf="capturedImages[2]">Lateral Esquerda</p>
                                        <img *ngIf="capturedImages[2]" [src]="capturedImages[2]" alt="Imagem Lateral Esquerda">
                                        <button *ngIf="capturedImages[2]" (click)="removeImage(2)"><i class="bi bi-x-circle-fill"></i></button>
                                      </div>

                                      <!-- Captura de Imagem Nuca -->
                                      <div class="captured-image">
                                        <p *ngIf="capturedImages[3]">Nuca</p>
                                        <img *ngIf="capturedImages[3]" [src]="capturedImages[3]" alt="Imagem Nuca">
                                        <button *ngIf="capturedImages[3]" (click)="removeImage(3)"><i class="bi bi-x-circle-fill"></i></button>
                                      </div>
                                    </div>
                                    <ng-template #noImages>
                                      <p>Nenhuma imagem capturada.</p>
                                    </ng-template>

                                  </div>
                                </div>

                               </div>
                          </div>



            <div class="modal-footer">
                <button type="button" (click)="stopCamera()" data-bs-dismiss="modal" class="btn btn-secondary">
                    Fechar
                </button>
                <button type="submit" type="submit" (click)="onSubmit()" [disabled]="isLoading" class="btn btn-primary">{{ isLoading ? 'Enviando...' : 'Enviar Imagens' }}</button>
            </div>
            </div>
        </form>
  </div>
</div>
</div>


