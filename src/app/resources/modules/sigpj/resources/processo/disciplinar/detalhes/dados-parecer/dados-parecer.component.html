<sigpj-registar-ou-editar-parecer-model *ngIf="this.getId" [disciplinarId]="this.getId"
  (eventRegistarOuEditDisciplinarModel)="this.recarregar()">
</sigpj-registar-ou-editar-parecer-model>

<sigpj-registar-ou-editar-parecer-peca-model *ngIf="this.getId" [disciplinarId]="this.getId"
  (eventRegistarOuEditDisciplinarModel)="this.recarregar()">
</sigpj-registar-ou-editar-parecer-peca-model>

<aside class="text-center" *ngIf="!this.dadosParecer; else verDadosParecer">
  <br><br><br>
  Sem dados adicionados
</aside>
<ng-template #verDadosParecer>
  <div class="col-md-12 pull-left">
    <aside class="mb-1">
      <b>ID: </b> {{ this.dadosParecer?.id }}
    </aside>
    <aside class="mb-1">
      <b>Nº do Processo: </b> {{this.dadosParecer?.numero_processo}}
    </aside>
    <aside class="mb-1">
      <b>Nº do Oficío: </b> {{ this.dadosParecer?.numero_oficio }}
    </aside>
    <aside class="mb-1">
      <b>Data do Oficío: </b> {{ this.dadosParecer?.data }}
    </aside>
    <aside class="mb-1">
      <b>Parecer:</b> {{ this.dadosParecer?.assunto }}<br />
    </aside>
  </div>

</ng-template>

<nav class="navbar navbar-light" style="margin-top:5em">
  <form class="form-inline">
    <select class="form-control mr-sm-1" (change)="filtrar('perPage', $event)">
      <option *ngFor="let item of [5, 10, 20, 50]" [value]="item">
        {{ item }}
      </option>
    </select>
    <input class="form-control mr-sm-1" type="text" [ngModel]="filtro.search"
      (ngModelChange)="filtrar('search', $event)" placeholder="Pesquisa ..." />
    <button (click)="this.recarregar()" id="btpe1" class="btn btn-outline-success my-2 my-sm-0" type="submit">
      <i style="font-size: 14px" class="fa fa-refresh fa-spin fa-3x fa-fw"></i>
      <b>Pesquisar</b>
    </button>
    <a *ngIf="!this.dadosParecer; else mostrarAdicionarPeca" data-toggle="modal" id="book"
      class="btn btn btn-primary btn-rounded float-right" data-target="#modalRegistarOuEditarParecer">
      <i class="fa fa-plus-circle"></i> <b> Adicionar parecer</b>
    </a>
    <ng-template #mostrarAdicionarPeca>
      <a data-toggle="modal" id="book" class="btn btn btn-primary btn-rounded float-right"
        data-target="#modalRegistarOuEditarParecerPeca">
        <i class="fa fa-plus-circle"></i> <b> Adicionar Peça</b>
      </a>
    </ng-template>
  </form>
</nav>
<div class="col-sm-12">
  <table class="table table-border table-striped custom-table datatable mb-0">
    <thead>
      <tr>
        <th>Ordem</th>
        <th class="text-center">Visualizar</th>
        <th class="text-center">Baixar</th>
        <th class="text-center">Data de registo</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of this.pecasParecer | paginate
              : { id: 'processo-disciplinar',
                  itemsPerPage: this.pagination.per_page,
                  currentPage: this.pagination.current_page,
                  totalItems: this.pagination.total
                }; index as i  ">
        <td class="text-left">{{this.totalBase + i}}</td>
        <td class="text-center">
          <a class="btn btn-outline-primary bi bi-eye" href="javascript:void(0)" (click)="visualizar(item)"
            data-toggle="modal" data-target="#modalVisualizarDocumento">
          </a>
        </td>

        <td class="text-center">
          <button type="submit" class="btn btn-outline-primary bi bi-download" (click)="baixar(item)"></button>
        </td>
        <td class="text-center">
          {{item.created_at}}
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="col-md-12">
  <div class="row">
    <div class="col-sm-6">
      Mostrando de {{ this.pagination.current_page }} á
      {{ this.pagination.per_page }} de
      {{ this.pagination.total }} Registo
    </div>
    <div class="col-sm-6">
      <div class="float-right">
        <pagination-controls id="dados-parecer" (pageChange)="this.filtrar('page', $event)" [directionLinks]="true"
          [autoHide]="true" previousLabel="Anterior" nextLabel="Próximo" [maxSize]="4"
          [responsive]="true"></pagination-controls>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modalVisualizarDocumento" aria-labelledby="modalVisualizarDocumento" aria-hidden="true">
  <div class="modal-dialog" role="document" style="overflow-y: hidden;min-width: 70%;">
    <div class="modal-content">
      <div class="modal-header">
        <h5>
          <i class="fa fa-user"></i>
          Visualizar documento
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="content">
        <div class="modal-body">
          <div class="row">
            <div class="col-sm-12">
              <nav class="navbar navbar-light bg-light">
                <h3>Visualizar documento</h3>
              </nav>
              <div class="col-sm-12">
                <aside *ngIf="carregarDocumento;else carregarDocumentoVerMensagem">
                  <div class="container">
                    <div class="row justify-content-center">
                      Carregando documento ...
                      <div class="col-sm-12 text-center">
                        <div class="spinner-border text-primary" style="width: 2rem; height: 2rem;" role="status">
                        </div>
                      </div>
                    </div>
                  </div>
                </aside>
                <ng-template #carregarDocumentoVerMensagem>
                  <aside *ngIf="fileUrl; else verMensagem">
                    <iframe [src]="fileUrl" width="100%" height="700px"></iframe>
                  </aside>
                  <ng-template #verMensagem>
                    <div class="container">
                      <div class="row justify-content-center">
                        <div class="col-sm-12 text-center">
                          Sem documento adicionado
                        </div>
                      </div>
                    </div>
                  </ng-template>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            <span class="fa fa-close m-r-2"></span>Fechar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
